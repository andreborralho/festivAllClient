(function(e){function s(e){if(!n[e].el){delete n[e];return false}return true}function o(){if(jq.os.android&&!jq.os.chrome&&jq.os.webkit){var t=false;e.bind(e.touchLayer,["cancel-enter-edit","exit-edit"],function(e){if(t){t=false;for(var r in n)if(s(r)&&n[r].androidFormsMode)n[r].stopFormsMode()}})}i=true}var t=75;var n=[];var r=function(t){if(!t.jqScrollerId)t.jqScrollerId=e.uuid();return t.jqScrollerId};e.fn["scroller"]=function(t){var i,s;for(var o=0;o<this.length;o++){s=r(this[o]);if(!n[s]){if(!t)t={};if(!e.feat.nativeTouchScroll)t.useJsScroll=true;i=u(this[o],t);n[s]=i}else{i=n[s]}}return this.length==1?i:this};var i=false;var u=function(){function c(t,n){var r=document.createElement("div");r.style.position="absolute";r.style.width=t+"px";r.style.height=n+"px";r.style[e.feat.cssPrefix+"BorderRadius"]="2px";r.style.borderRadius="2px";r.style.display="none";r.className="scrollBar";r.style.background="black";return r}var r=e.feat.cssTransformStart;var s=e.feat.cssTransformEnd;var u,a;var f=function(t,n){var r;if(!i&&e.touchLayer&&e.isObject(e.touchLayer))o();else if(!e.touchLayer||!e.isObject(e.touchLayer))e.touchLayer={};if(typeof t=="string"||t instanceof String){r=document.getElementById(t)}else{r=t}if(!r){alert("Could not find element for scroller "+t);return}if(jq.os.desktop)return new l(r,n);else if(n.useJsScroll)return new u(r,n);return new a(r,n)};var l=function(t,n){this.el=t;this.jqEl=e(this.el);for(var r in n){this[r]=n[r]}};l.prototype={refresh:false,refreshContent:"Pull to Refresh",refreshHangTimeout:2e3,refreshHeight:60,refreshElement:null,refreshCancelCB:null,refreshRunning:false,scrollTop:0,scrollLeft:0,preventHideRefresh:true,verticalScroll:true,horizontalScroll:false,refreshTriggered:false,moved:false,eventsActive:false,rememberEventsActive:false,scrollingLocked:false,autoEnable:true,blockFormsFix:false,loggedPcentY:0,loggedPcentX:0,infinite:false,infiniteEndCheck:false,infiniteTriggered:false,scrollSkip:false,scrollTopInterval:null,scrollLeftInterval:null,bubbles:true,lockBounce:false,_scrollTo:function(e,t){t=parseInt(t,10);if(t===0||isNaN(t)){this.el.scrollTop=Math.abs(e.y);this.el.scrollLeft=Math.abs(e.x);return}var n=10;var r=(this.el.scrollTop-e.y)/Math.ceil(t/n);var i=(this.el.scrollLeft-e.x)/Math.ceil(t/n);var s=this;var o=Math.ceil(this.el.scrollTop-e.y)/r;var u=Math.ceil(this.el.scrollLeft-e.x)/r;var a=0,f=0;s.scrollTopInterval=window.setInterval(function(){s.el.scrollTop-=r;f++;if(f>=o){s.el.scrollTop=e.y;clearInterval(s.scrollTopInterval)}},n);s.scrollLeftInterval=window.setInterval(function(){s.el.scrollLeft-=i;a++;if(a>=u){s.el.scrollLeft=e.x;clearInterval(s.scrollLeftInterval)}},n)},enable:function(){},disable:function(){},hideScrollbars:function(){},addPullToRefresh:function(){},_scrollToTop:function(e){this._scrollTo({x:0,y:0},e)},_scrollToBottom:function(e){this._scrollTo({x:0,y:this.el.scrollHeight-this.el.offsetHeight},e)},scrollToBottom:function(e){return this._scrollToBottom(e)},scrollToTop:function(e){return this._scrollToTop(e)},init:function(t,r){this.el=t;this.jqEl=e(this.el);this.defaultProperties();for(var i in r){this[i]=r[i]}var s=this;var o=function(){if(s.eventsActive)s.adjustScroll()};this.jqEl.bind("destroy",function(){s.disable(true);var t=s.el.jqScrollerId;if(n[t])delete n[t];e.unbind(e.touchLayer,"orientationchange-reshape",o)});e.bind(e.touchLayer,"orientationchange-reshape",o)},needsFormsFix:function(t){return this.useJsScroll&&this.isEnabled()&&this.el.style.display!="none"&&e(t).closest(this.jqEl).size()>0},handleEvent:function(e){if(!this.scrollingLocked){switch(e.type){case"touchstart":clearInterval(this.scrollTopInterval);this.preventHideRefresh=!this.refreshRunning;this.moved=false;this.onTouchStart(e);if(!this.bubbles)e.stopPropagation();break;case"touchmove":this.onTouchMove(e);if(!this.bubbles)e.stopPropagation();break;case"touchend":this.onTouchEnd(e);if(!this.bubbles)e.stopPropagation();break;case"scroll":this.onScroll(e);break}}},coreAddPullToRefresh:function(t){if(t)this.refreshElement=t;var n;if(this.refreshElement===null){var r=document.getElementById(this.container.id+"_pulldown");if(r!==null){n=jq(r)}else{n=jq("<div id='"+this.container.id+"_pulldown' class='jqscroll_refresh' style='border-radius:.6em;border: 1px solid #2A2A2A;background-image: -webkit-gradient(linear,left top,left bottom,color-stop(0,#666666),color-stop(1,#222222));background:#222222;margin:0px;height:60px;position:relative;text-align:center;line-height:60px;color:white;width:100%;'>"+this.refreshContent+"</div>")}}else{n=jq(this.refreshElement)}var i=n.get(0);this.refreshContainer=jq('<div style="overflow:hidden;width:100%;height:0;margin:0;padding:0;padding-left:5px;padding-right:5px;display:none;"></div>');e(this.el).prepend(this.refreshContainer.append(i,"top"));this.refreshContainer=this.refreshContainer[0]},fireRefreshRelease:function(t,n){if(!this.refresh||!t)return;var r=e.trigger(this,"refresh-release",[t])!==false;this.preventHideRefresh=false;this.refreshRunning=true;if(r){var i=this;if(this.refreshHangTimeout>0)this.refreshCancelCB=setTimeout(function(){i.hideRefresh()},this.refreshHangTimeout)}},setRefreshContent:function(e){jq(this.container).find(".jqscroll_refresh").html(e)},lock:function(){if(this.scrollingLocked)return;this.scrollingLocked=true;this.rememberEventsActive=this.eventsActive;if(!this.eventsActive){this.initEvents()}},unlock:function(){if(!this.scrollingLocked)return;this.scrollingLocked=false;if(!this.rememberEventsActive){this.removeEvents()}},scrollToItem:function(t,n){if(!e.is$(t))t=e(t);var r,i,s,o;if(n=="bottom"){i=t.offset();r=i.top-this.jqEl.offset().bottom+i.height;r+=4}else{o=t.offset().top;r=o-document.body.scrollTop;s=this.jqEl.offset().top;if(document.body.scrollTop<s){r-=s}r-=4}this.scrollBy({y:r,x:0},0)},setPaddings:function(t,n){var r=e(this.el);var i=numOnly(r.css("paddingTop"));r.css("paddingTop",t+"px").css("paddingBottom",n+"px");this.scrollBy({y:t-i,x:0})},divide:function(e,t){return t!==0?e/t:0},isEnabled:function(){return this.eventsActive},addInfinite:function(){this.infinite=true},clearInfinite:function(){this.infiniteTriggered=false;this.scrollSkip=true}};u=function(t,n){this.init(t,n);this.container=this.el.parentNode;this.container.jqScrollerId=t.jqScrollerId;this.jqEl=e(this.container);if(this.container.style.overflow!="hidden")this.container.style.overflow="hidden";this.addPullToRefresh(null,true);if(this.autoEnable)this.enable(true);var r;if(this.verticalScroll&&this.verticalScroll===true&&this.scrollBars===true){r=c(5,20);r.style.top="0px";if(this.vScrollCSS)r.className=this.vScrollCSS;r.style.display="none";this.container.appendChild(r);this.vscrollBar=r;r=null}if(this.horizontalScroll&&this.horizontalScroll===true&&this.scrollBars===true){r=c(20,5);r.style.bottom="0px";if(this.hScrollCSS)r.className=this.hScrollCSS;r.style.display="none";this.container.appendChild(r);this.hscrollBar=r;r=null}if(this.horizontalScroll)this.el.style["float"]="left";this.el.hasScroller=true};a=function(t,n){if(n.nativeParent){t=t.parentNode}this.init(t,n);var r=e(t);if(n.noParent!==true){var i=r.parent();r.css("height",i.height()).css("width",i.width());r.insertBefore(r.parent());i.remove()}this.container=this.el;r.css("-webkit-overflow-scrolling","touch");if(n.autoEnable)this.enable()};a.prototype=new l;u.prototype=new l;a.prototype.defaultProperties=function(){this.refreshContainer=null;this.dY=this.cY=0;this.dX=this.cX=0;this.cancelPropagation=false;this.loggedPcentY=0;this.loggedPcentX=0;var e=this;this.adjustScrollOverflowProxy_=function(){e.jqEl.css("overflow","auto");e.jqEl.parent().css("overflow","hidden")}};a.prototype.enable=function(e){if(this.eventsActive)return;this.eventsActive=true;this.el.style.overflow="auto";this.el.parentNode.style.overflow="hidden";if(!e)this.adjustScroll();this.el.addEventListener("touchstart",this,false);this.el.addEventListener("scroll",this,false)};a.prototype.disable=function(e){if(!this.eventsActive)return;this.logPos(this.el.scrollLeft,this.el.scrollTop);if(!e){this.el.style.overflow="hidden"}this.el.removeEventListener("touchstart",this,false);this.el.removeEventListener("touchmove",this,false);this.el.removeEventListener("touchend",this,false);this.el.removeEventListener("scroll",this,false);this.eventsActive=false};a.prototype.addPullToRefresh=function(e,t){this.el.removeEventListener("touchstart",this,false);this.el.addEventListener("touchstart",this,false);if(!t)this.refresh=true;if(this.refresh&&this.refresh===true){this.coreAddPullToRefresh(e);this.refreshContainer.style.position="absolute";this.refreshContainer.style.top="-60px";this.refreshContainer.style.height="60px";this.refreshContainer.style.display="block"}};a.prototype.onTouchStart=function(e){if(this.el.scrollTop===0)this.el.scrollTop=1;if(this.el.scrollTop===this.el.scrollHeight-this.el.clientHeight)this.el.scrollTop-=1;if(this.horizontalScroll){if(this.el.scrollLeft===0)this.el.scrollLeft=1;if(this.el.scrollLeft===this.el.scrollWidth-this.el.clientWidth)this.el.scrollLeft-=1}if(this.refreshCancelCB)clearTimeout(this.refreshCancelCB);this.el.addEventListener("touchmove",this,false);this.dY=e.touches[0].pageY;if(this.refresh||this.infinite){if(this.refresh&&this.dY<0){this.showRefresh()}}};a.prototype.onTouchMove=function(t){var n=t.touches[0].pageY-this.dY;var r=t.touches[0].pageX-this.dX;if(this.hasVertScroll&&this.el.clientHeight==this.el.scrollHeight){t.preventDefault()}if(this.hasHorScroll&&this.el.clientWidth==this.el.scrollWidth){t.preventDefault()}if(!this.moved){e.trigger(this,"scrollstart",[this.el]);e.trigger(e.touchLayer,"scrollstart",[this.el]);this.el.addEventListener("touchend",this,false);this.moved=true}var i=n-this.cY;var s=r-this.cX;if(this.refresh&&this.el.scrollTop<0){this.showRefresh()}else if(this.refreshTriggered&&this.refresh&&this.el.scrollTop>this.refreshHeight){this.refreshTriggered=false;if(this.refreshCancelCB)clearTimeout(this.refreshCancelCB);this.hideRefresh(false);e.trigger(this,"refresh-cancel")}this.cY=n;this.cX=r};a.prototype.showRefresh=function(){if(!this.refreshTriggered){this.refreshTriggered=true;e.trigger(this,"refresh-trigger")}};a.prototype.onTouchEnd=function(t){var n=this.el.scrollTop<=-this.refreshHeight;this.fireRefreshRelease(n,true);if(n&&this.refresh){this.refreshContainer.style.position="relative";this.refreshContainer.style.top="0px"}this.dY=this.cY=0;this.el.removeEventListener("touchmove",this,false);this.el.removeEventListener("touchend",this,false);this.infiniteEndCheck=true;if(this.infinite&&!this.infiniteTriggered&&Math.abs(this.el.scrollTop)>=this.el.scrollHeight-this.el.clientHeight){this.infiniteTriggered=true;e.trigger(this,"infinite-scroll");this.infiniteEndCheck=true}this.touchEndFired=true;var r=200;var i=this;var s={top:this.el.scrollTop,left:this.el.scrollLeft};var o=0;i.nativePolling=setInterval(function(){o++;if(o>=r){clearInterval(i.nativePolling);return}if(i.el.scrollTop!=s.top||i.el.scrollLeft!=s.left){clearInterval(i.nativePolling);e.trigger(e.touchLayer,"scrollend",[i.el]);e.trigger(i,"scrollend",[i.el])}},20)};a.prototype.hideRefresh=function(n){if(this.preventHideRefresh)return;var r=this;var i=function(t){if(!t){r.el.style[e.feat.cssPrefix+"Transform"]="none";r.el.style[e.feat.cssPrefix+"TransitionProperty"]="none";r.el.scrollTop=0;r.logPos(r.el.scrollLeft,0)}r.refreshContainer.style.top="-60px";r.refreshContainer.style.position="absolute";r.dY=r.cY=0;e.trigger(r,"refresh-finish")};if(n===false||!r.jqEl.css3Animate){i()}else{r.jqEl.css3Animate({y:r.el.scrollTop-r.refreshHeight+"px",x:"0%",time:t+"ms",complete:i})}this.refreshTriggered=false};a.prototype.hideScrollbars=function(){};a.prototype.scrollTo=function(e,t){this.logPos(e.x,e.y);e.x*=-1;e.y*=-1;return this._scrollTo(e,t)};a.prototype.scrollBy=function(e,t){e.x+=this.el.scrollLeft;e.y+=this.el.scrollTop;this.logPos(this.el.scrollLeft,this.el.scrollTop);return this._scrollTo(e,t)};a.prototype.scrollToBottom=function(e){this._scrollToBottom(e);this.logPos(this.el.scrollLeft,this.el.scrollTop)};a.prototype.onScroll=function(t){if(this.infinite&&this.touchEndFired){this.touchEndFired=false;return}if(this.scrollSkip){this.scrollSkip=false;return}if(this.infinite){if(!this.infiniteTriggered&&Math.abs(this.el.scrollTop)>=this.el.scrollHeight-this.el.clientHeight){this.infiniteTriggered=true;e.trigger(this,"infinite-scroll");this.infiniteEndCheck=true}}var n=this;if(this.infinite&&this.infiniteEndCheck&&this.infiniteTriggered){this.infiniteEndCheck=false;e.trigger(n,"infinite-scroll-end")}};a.prototype.logPos=function(e,t){this.loggedPcentX=this.divide(e,this.el.scrollWidth);this.loggedPcentY=this.divide(t,this.el.scrollHeight);this.scrollLeft=e;this.scrollTop=t;if(isNaN(this.loggedPcentX))this.loggedPcentX=0;if(isNaN(this.loggedPcentY))this.loggedPcentY=0};a.prototype.adjustScroll=function(){this.adjustScrollOverflowProxy_();this.el.scrollLeft=this.loggedPcentX*this.el.scrollWidth;this.el.scrollTop=this.loggedPcentY*this.el.scrollHeight;this.logPos(this.el.scrollLeft,this.el.scrollTop)};u.prototype.defaultProperties=function(){this.boolScrollLock=false;this.currentScrollingObject=null;this.elementInfo=null;this.verticalScroll=true;this.horizontalScroll=false;this.scrollBars=true;this.vscrollBar=null;this.hscrollBar=null;this.hScrollCSS="scrollBar";this.vScrollCSS="scrollBar";this.firstEventInfo=null;this.moved=false;this.preventPullToRefresh=true;this.isScrolling=false;this.androidFormsMode=false;this.refreshSjqeKeep=false;this.lastScrollbar="";this.finishScrollingObject=null;this.container=null;this.scrollingFinishCB=null;this.loggedPcentY=0;this.loggedPcentX=0};u.prototype.enable=function(e){if(this.eventsActive)return;this.eventsActive=true;if(!e)this.adjustScroll();else this.scrollerMoveCSS({x:0,y:0},0);this.container.addEventListener("touchstart",this,false);this.container.addEventListener("touchmove",this,false);this.container.addEventListener("touchend",this,false)};u.prototype.adjustScroll=function(){var e=this.getViewportSize();this.scrollerMoveCSS({x:Math.round(this.loggedPcentX*(this.el.clientWidth-e.w)),y:Math.round(this.loggedPcentY*(this.el.clientHeight-e.h))},0)};u.prototype.disable=function(){if(!this.eventsActive)return;var e=this.getCSSMatrix(this.el);this.logPos(numOnly(e.e)-numOnly(this.container.scrollLeft),numOnly(e.f)-numOnly(this.container.scrollTop));this.container.removeEventListener("touchstart",this,false);this.container.removeEventListener("touchmove",this,false);this.container.removeEventListener("touchend",this,false);this.eventsActive=false};u.prototype.addPullToRefresh=function(e,t){if(!t)this.refresh=true;if(this.refresh&&this.refresh===true){this.coreAddPullToRefresh(e);this.el.style.overflow="visible"}};u.prototype.hideScrollbars=function(){if(this.hscrollBar){this.hscrollBar.style.display="none";this.hscrollBar.style[e.feat.cssPrefix+"TransitionDuration"]="0ms"}if(this.vscrollBar){this.vscrollBar.style.display="none";this.vscrollBar.style[e.feat.cssPrefix+"TransitionDuration"]="0ms"}};u.prototype.getViewportSize=function(){var e=window.getComputedStyle(this.container);if(isNaN(numOnly(e.paddingTop)))alert(typeof e.paddingTop+"::"+e.paddingTop+":");return{h:this.container.clientHeight>window.innerHeight?window.innerHeight:this.container.clientHeight-numOnly(e.paddingTop)-numOnly(e.paddingBottom),w:this.container.clientWidth>window.innerWidth?window.innerWidth:this.container.clientWidth-numOnly(e.paddingLeft)-numOnly(e.paddingRight)}};u.prototype.onTouchStart=function(t){this.moved=false;this.currentScrollingObject=null;if(!this.container)return;if(this.refreshCancelCB){clearTimeout(this.refreshCancelCB);this.refreshCancelCB=null}if(this.scrollingFinishCB){clearTimeout(this.scrollingFinishCB);this.scrollingFinishCB=null}if(t.touches.length!=1||this.boolScrollLock)return;if(t.touches[0].target&&t.touches[0].target.type!==undefined){var n=t.touches[0].target.tagName.toLowerCase();var r=t.touches[0].target.type.toLowerCase();if(n=="select")return}var i={top:0,left:0,speedY:0,speedX:0,absSpeedY:0,absSpeedX:0,deltaY:0,deltaX:0,absDeltaY:0,absDeltaX:0,y:0,x:0,duration:0};this.elementInfo={};var s=this.getViewportSize();this.elementInfo.bottomMargin=s.h;this.elementInfo.maxTop=this.el.clientHeight-this.elementInfo.bottomMargin;if(this.elementInfo.maxTop<0)this.elementInfo.maxTop=0;this.elementInfo.divHeight=this.el.clientHeight;this.elementInfo.rightMargin=s.w;this.elementInfo.maxLeft=this.el.clientWidth-this.elementInfo.rightMargin;if(this.elementInfo.maxLeft<0)this.elementInfo.maxLeft=0;this.elementInfo.divWidth=this.el.clientWidth;this.elementInfo.hasVertScroll=this.verticalScroll||this.elementInfo.maxTop>0;this.elementInfo.hasHorScroll=this.elementInfo.maxLeft>0;this.elementInfo.requiresVScrollBar=this.vscrollBar&&this.elementInfo.hasVertScroll;this.elementInfo.requiresHScrollBar=this.hscrollBar&&this.elementInfo.hasHorScroll;this.saveEventInfo(t);this.saveFirstEventInfo(t);var o=this.getCSSMatrix(this.el);i.top=numOnly(o.f)-numOnly(this.container.scrollTop);i.left=numOnly(o.e)-numOnly(this.container.scrollLeft);this.container.scrollTop=this.container.scrollLeft=0;this.currentScrollingObject=this.el;if(this.refresh&&i.top===0){this.refreshContainer.style.display="block";this.refreshHeight=this.refreshContainer.firstChild.clientHeight;this.refreshContainer.firstChild.style.top=-this.refreshHeight+"px";this.refreshContainer.style.overflow="visible";this.preventPullToRefresh=false}else if(i.top<0){this.preventPullToRefresh=true;if(this.refresh)this.refreshContainer.style.overflow="hidden"}i.x=i.left;i.y=i.top;if(this.setVScrollBar(i,0,0)){if(this.container.clientWidth>window.innerWidth)this.vscrollBar.style.right="0px";else this.vscrollBar.style.right="0px";this.vscrollBar.style[e.feat.cssPrefix+"Transition"]=""}if(this.setHScrollBar(i,0,0)){if(this.container.clientHeight>window.innerHeight)this.hscrollBar.style.top=window.innerHeight-numOnly(this.hscrollBar.style.height)+"px";else this.hscrollBar.style.bottom=numOnly(this.hscrollBar.style.height);this.hscrollBar.style[e.feat.cssPrefix+"Transition"]=""}this.lastScrollInfo=i;this.hasMoved=false;this.scrollerMoveCSS(this.lastScrollInfo,0)};u.prototype.getCSSMatrix=function(t){if(this.androidFormsMode){var n=parseInt(t.style.marginTop,10);var r=parseInt(t.style.marginLeft,10);if(isNaN(n))n=0;if(isNaN(r))r=0;return{f:n,e:r}}else{var i=e.getCssMatrix(t);return i}};u.prototype.saveEventInfo=function(e){this.lastEventInfo={pageX:e.touches[0].pageX,pageY:e.touches[0].pageY,time:e.timeStamp}};u.prototype.saveFirstEventInfo=function(e){this.firstEventInfo={pageX:e.touches[0].pageX,pageY:e.touches[0].pageY,time:e.timeStamp}};u.prototype.setVScrollBar=function(e,t,n){if(!this.elementInfo.requiresVScrollBar)return false;var r=parseFloat(this.elementInfo.bottomMargin/this.elementInfo.divHeight)*this.elementInfo.bottomMargin+"px";if(numOnly(r)>this.elementInfo.bottomMargin)r=this.elementInfo.bottomMargin+"px";if(r!=this.vscrollBar.style.height)this.vscrollBar.style.height=r;var i=this.elementInfo.bottomMargin-numOnly(this.vscrollBar.style.height)-(this.elementInfo.maxTop+e.y)/this.elementInfo.maxTop*(this.elementInfo.bottomMargin-numOnly(this.vscrollBar.style.height));if(i>this.elementInfo.bottomMargin)i=this.elementInfo.bottomMargin;if(i<0)i=0;this.scrollbarMoveCSS(this.vscrollBar,{x:0,y:i},t,n);return true};u.prototype.setHScrollBar=function(e,t,n){if(!this.elementInfo.requiresHScrollBar)return false;var r=parseFloat(this.elementInfo.rightMargin/this.elementInfo.divWidth)*this.elementInfo.rightMargin+"px";if(r!=this.hscrollBar.style.width)this.hscrollBar.style.width=r;var i=this.elementInfo.rightMargin-numOnly(this.hscrollBar.style.width)-(this.elementInfo.maxLeft+e.x)/this.elementInfo.maxLeft*(this.elementInfo.rightMargin-numOnly(this.hscrollBar.style.width));if(i>this.elementInfo.rightMargin)i=this.elementInfo.rightMargin;if(i<0)i=0;this.scrollbarMoveCSS(this.hscrollBar,{x:i,y:0},t,n);return true};u.prototype.onTouchMove=function(t){if(this.currentScrollingObject===null)return;var n=this.calculateMovement(t);this.calculateTarget(n);this.lastScrollInfo=n;if(!this.moved){e.trigger(this,"scrollstart");e.trigger(e.touchLayer,"scrollstart",[this.el]);if(this.elementInfo.requiresVScrollBar)this.vscrollBar.style.display="block";if(this.elementInfo.requiresHScrollBar)this.hscrollBar.style.display="block"}this.moved=true;if(this.refresh&&n.top===0){this.refreshContainer.style.display="block";this.refreshHeight=this.refreshContainer.firstChild.clientHeight;this.refreshContainer.firstChild.style.top=-this.refreshHeight+"px";this.refreshContainer.style.overflow="visible";this.preventPullToRefresh=false}else if(n.top<0){this.preventPullToRefresh=true;if(this.refresh)this.refreshContainer.style.overflow="hidden"}this.saveEventInfo(t);if(this.isScrolling===false){this.isScrolling=true;if(this.onScrollStart)this.onScrollStart()}var r=this.getCSSMatrix(this.el);this.lastScrollInfo.top=numOnly(r.f);this.lastScrollInfo.left=numOnly(r.e);this.recalculateDeltaY(this.lastScrollInfo);this.recalculateDeltaX(this.lastScrollInfo);this.checkYboundary(this.lastScrollInfo);if(this.elementInfo.hasHorScroll)this.checkXboundary(this.lastScrollInfo);var i=this.lastScrollInfo.y>0&&this.lastScrollInfo.deltaY>0;var s=this.lastScrollInfo.y<-this.elementInfo.maxTop&&this.lastScrollInfo.deltaY<0;if(i||s){var o=i?this.lastScrollInfo.y:-this.lastScrollInfo.y-this.elementInfo.maxTop;var u=(this.container.clientHeight-o)/this.container.clientHeight;if(u<.5)u=.5;var a=0;if(i&&this.lastScrollInfo.top>0||s&&this.lastScrollInfo.top<-this.elementInfo.maxTop){a=this.lastScrollInfo.top}else if(s){a=-this.elementInfo.maxTop}var f=this.lastScrollInfo.deltaY*u;var l=Math.abs(this.lastScrollInfo.deltaY*u);if(l<1)f=i?1:-1;this.lastScrollInfo.y=a+f}if(this.elementInfo.hasHorScroll){i=this.lastScrollInfo.x>0&&this.lastScrollInfo.deltaX>0;s=this.lastScrollInfo.x<-this.elementInfo.maxLeft&&this.lastScrollInfo.deltaX<0;if(i||s){var o=i?this.lastScrollInfo.x:-this.lastScrollInfo.x-this.elementInfo.maxLeft;var u=(this.container.clientWidth-o)/this.container.clientWidth;if(u<.5)u=.5;var a=0;if(i&&this.lastScrollInfo.left>0||s&&this.lastScrollInfo.left<-this.elementInfo.maxLeft){a=this.lastScrollInfo.left}else if(s){a=-this.elementInfo.maxLeft}var c=this.lastScrollInfo.deltaX*u;var h=Math.abs(this.lastScrollInfo.deltaX*u);if(h<1)c=i?1:-1;this.lastScrollInfo.x=a+c}}if(this.lockBounce){if(this.lastScrollInfo.x>0)this.lastScrollInfo.x=0;else if(this.lastScrollInfo.x*-1>this.elementInfo.maxLeft)this.lastScrollInfo.x=this.elementInfo.maxLeft*-1;if(this.lastScrollInfo.y>0)this.lastScrollInfo.y=0;else if(this.lastScrollInfo.y*-1>this.elementInfo.maxTop)this.lastScrollInfo.y=this.elementInfo.maxTop*-1}this.scrollerMoveCSS(this.lastScrollInfo,0);this.setVScrollBar(this.lastScrollInfo,0,0);this.setHScrollBar(this.lastScrollInfo,0,0);if(this.refresh&&!this.preventPullToRefresh){if(!this.refreshTriggered&&this.lastScrollInfo.top>this.refreshHeight){this.refreshTriggered=true;e.trigger(this,"refresh-trigger")}else if(this.refreshTriggered&&this.lastScrollInfo.top<this.refreshHeight){this.refreshTriggered=false;e.trigger(this,"refresh-cancel")}}if(this.infinite&&!this.infiniteTriggered){if(Math.abs(this.lastScrollInfo.top)>=this.el.clientHeight-this.container.clientHeight){this.infiniteTriggered=true;e.trigger(this,"infinite-scroll")}}};u.prototype.calculateMovement=function(e,t){var n={top:0,left:0,speedY:0,speedX:0,absSpeedY:0,absSpeedX:0,deltaY:0,deltaX:0,absDeltaY:0,absDeltaX:0,y:0,x:0,duration:0};var r=t?this.firstEventInfo:this.lastEventInfo;var i=t?e.pageX:e.touches[0].pageX;var s=t?e.pageY:e.touches[0].pageY;var o=t?e.time:e.timeStamp;n.deltaY=this.elementInfo.hasVertScroll?s-r.pageY:0;n.deltaX=this.elementInfo.hasHorScroll?i-r.pageX:0;n.time=o;n.duration=o-r.time;return n};u.prototype.calculateTarget=function(e){e.y=this.lastScrollInfo.y+e.deltaY;e.x=this.lastScrollInfo.x+e.deltaX};u.prototype.checkYboundary=function(e){var t=this.container.clientHeight/2;var n=this.elementInfo.maxTop+t;if(e.y>t)e.y=t;else if(-e.y>n)e.y=-n;else return;this.recalculateDeltaY(e)};u.prototype.checkXboundary=function(e){var t=this.container.clientWidth/2;var n=this.elementInfo.maxLeft+t;if(e.x>t)e.x=t;else if(-e.x>n)e.x=-n;else return;this.recalculateDeltaX(e)};u.prototype.recalculateDeltaY=function(e){var t=Math.abs(e.deltaY);e.deltaY=e.y-e.top;newAbsDeltaY=Math.abs(e.deltaY);e.duration=e.duration*newAbsDeltaY/t};u.prototype.recalculateDeltaX=function(e){var t=Math.abs(e.deltaX);e.deltaX=e.x-e.left;newAbsDeltaX=Math.abs(e.deltaX);e.duration=e.duration*newAbsDeltaX/t};u.prototype.hideRefresh=function(n){var r=this;if(this.preventHideRefresh)return;this.scrollerMoveCSS({x:0,y:0,complete:function(){e.trigger(r,"refresh-finish")}},t);this.refreshTriggered=false};u.prototype.setMomentum=function(e){var t=.0012;e.speedY=this.divide(e.deltaY,e.duration);e.speedX=this.divide(e.deltaX,e.duration);e.absSpeedY=Math.abs(e.speedY);e.absSpeedX=Math.abs(e.speedX);e.absDeltaY=Math.abs(e.deltaY);e.absDeltaX=Math.abs(e.deltaX);if(e.absDeltaY>0){e.deltaY=(e.deltaY<0?-1:1)*e.absSpeedY*e.absSpeedY/(2*t);e.absDeltaY=Math.abs(e.deltaY);e.duration=e.absSpeedY/t;e.speedY=e.deltaY/e.duration;e.absSpeedY=Math.abs(e.speedY);if(e.absSpeedY<t*100||e.absDeltaY<5)e.deltaY=e.absDeltaY=e.duration=e.speedY=e.absSpeedY=0}else if(e.absDeltaX){e.deltaX=(e.deltaX<0?-1:1)*e.absSpeedX*e.absSpeedX/(2*t);e.absDeltaX=Math.abs(e.deltaX);e.duration=e.absSpeedX/t;e.speedX=e.deltaX/e.duration;e.absSpeedX=Math.abs(e.speedX);if(e.absSpeedX<t*100||e.absDeltaX<5)e.deltaX=e.absDeltaX=e.duration=e.speedX=e.absSpeedX=0}else e.duration=0};u.prototype.onTouchEnd=function(n){if(this.currentScrollingObject===null||!this.moved)return;this.finishScrollingObject=this.currentScrollingObject;this.currentScrollingObject=null;var r=this.calculateMovement(this.lastEventInfo,true);if(!this.androidFormsMode){this.setMomentum(r)}this.calculateTarget(r);var i=this.getCSSMatrix(this.el);r.top=numOnly(i.f);r.left=numOnly(i.e);this.checkYboundary(r);if(this.elementInfo.hasHorScroll)this.checkXboundary(r);var s=!this.preventPullToRefresh&&(r.top>this.refreshHeight||r.y>this.refreshHeight);this.fireRefreshRelease(s,r.top>0);if(this.refresh&&s){r.y=this.refreshHeight;r.duration=t}else if(r.y>=0){r.y=0;if(r.top>=0)r.duration=t}else if(-r.y>this.elementInfo.maxTop||this.elementInfo.maxTop===0){r.y=-this.elementInfo.maxTop;if(-r.top>this.elementInfo.maxTop)r.duration=t}if(this.elementInfo.hasHorScroll){if(r.x>=0){r.x=0;if(r.left>=0)r.duration=t}else if(-r.x>this.elementInfo.maxLeft||this.elementInfo.maxLeft===0){r.x=-this.elementInfo.maxLeft;if(-r.left>this.elementInfo.maxLeft)r.duration=t}}if(this.androidFormsMode)r.duration=0;this.scrollerMoveCSS(r,r.duration,"cubic-bezier(0.33,0.66,0.66,1)");this.setVScrollBar(r,r.duration,"cubic-bezier(0.33,0.66,0.66,1)");this.setHScrollBar(r,r.duration,"cubic-bezier(0.33,0.66,0.66,1)");this.setFinishCalback(r.duration);if(this.infinite&&!this.infiniteTriggered){if(Math.abs(r.y)>=this.el.clientHeight-this.container.clientHeight){this.infiniteTriggered=true;e.trigger(this,"infinite-scroll")}}};u.prototype.setFinishCalback=function(t){var n=this;this.scrollingFinishCB=setTimeout(function(){n.hideScrollbars();e.trigger(e.touchLayer,"scrollend",[n.el]);e.trigger(n,"scrollend",[n.el]);n.isScrolling=false;n.elementInfo=null;if(n.infinite)e.trigger(n,"infinite-scroll-end")},t)};u.prototype.startFormsMode=function(){if(this.blockFormsFix)return;var t=this.getCSSMatrix(this.el);this.refreshSjqeKeep=this.refresh;this.refresh=false;this.androidFormsMode=true;this.el.style[e.feat.cssPrefix+"Transform"]="none";this.el.style[e.feat.cssPrefix+"Transition"]="none";this.el.style[e.feat.cssPrefix+"Perspective"]="none";this.scrollerMoveCSS({x:numOnly(t.e),y:numOnly(t.f)},0);this.container.style[e.feat.cssPrefix+"Perspective"]="none";this.container.style[e.feat.cssPrefix+"BackfaceVisibility"]="visible";if(this.vscrollBar){this.vscrollBar.style[e.feat.cssPrefix+"Transform"]="none";this.vscrollBar.style[e.feat.cssPrefix+"Transition"]="none";this.vscrollBar.style[e.feat.cssPrefix+"Perspective"]="none";this.vscrollBar.style[e.feat.cssPrefix+"BackfaceVisibility"]="visible"}if(this.hscrollBar){this.hscrollBar.style[e.feat.cssPrefix+"Transform"]="none";this.hscrollBar.style[e.feat.cssPrefix+"Transition"]="none";this.hscrollBar.style[e.feat.cssPrefix+"Perspective"]="none";this.hscrollBar.style[e.feat.cssPrefix+"BackfaceVisibility"]="visible"}};u.prototype.stopFormsMode=function(){if(this.blockFormsFix)return;var t=this.getCSSMatrix(this.el);this.refresh=this.refreshSjqeKeep;this.androidFormsMode=false;this.el.style[e.feat.cssPrefix+"Perspective"]=1e3;this.el.style.marginTop=0;this.el.style.marginLeft=0;this.el.style[e.feat.cssPrefix+"Transition"]="0ms linear";this.scrollerMoveCSS({x:numOnly(t.e),y:numOnly(t.f)},0);this.container.style[e.feat.cssPrefix+"Perspective"]=1e3;this.container.style[e.feat.cssPrefix+"BackfaceVisibility"]="hidden";if(this.vscrollBar){this.vscrollBar.style[e.feat.cssPrefix+"Perspective"]=1e3;this.vscrollBar.style[e.feat.cssPrefix+"BackfaceVisibility"]="hidden"}if(this.hscrollBar){this.hscrollBar.style[e.feat.cssPrefix+"Perspective"]=1e3;this.hscrollBar.style[e.feat.cssPrefix+"BackfaceVisibility"]="hidden"}};u.prototype.scrollerMoveCSS=function(t,n,i){if(!n)n=0;if(!i)i="linear";n=numOnly(n);if(this.el&&this.el.style){if(this.eventsActive){if(this.androidFormsMode){this.el.style.marginTop=Math.round(t.y)+"px";this.el.style.marginLeft=Math.round(t.x)+"px"}else{this.el.style[e.feat.cssPrefix+"Transform"]="translate"+r+t.x+"px,"+t.y+"px"+s;this.el.style[e.feat.cssPrefix+"TransitionDuration"]=n+"ms";this.el.style[e.feat.cssPrefix+"TransitionTimingFunction"]=i}}this.logPos(t.x,t.y)}};u.prototype.logPos=function(e,t){var n;if(!this.elementInfo){n=this.getViewportSize()}else{n={h:this.elementInfo.bottomMargin,w:this.elementInfo.rightMargin}}this.loggedPcentX=this.divide(e,this.el.clientWidth-n.w);this.loggedPcentY=this.divide(t,this.el.clientHeight-n.h);this.scrollTop=t;this.scrollLeft=e};u.prototype.scrollbarMoveCSS=function(t,n,i,o){if(!i)i=0;if(!o)o="linear";if(t&&t.style){if(this.androidFormsMode){t.style.marginTop=Math.round(n.y)+"px";t.style.marginLeft=Math.round(n.x)+"px"}else{t.style[e.feat.cssPrefix+"Transform"]="translate"+r+n.x+"px,"+n.y+"px"+s;t.style[e.feat.cssPrefix+"TransitionDuration"]=i+"ms";t.style[e.feat.cssPrefix+"TransitionTimingFunction"]=o}}};u.prototype.scrollTo=function(e,t){if(!t)t=0;this.scrollerMoveCSS(e,t)};u.prototype.scrollBy=function(e,t){var n=this.getCSSMatrix(this.el);var r=numOnly(n.f);var i=numOnly(n.e);this.scrollTo({y:r-e.y,x:i-e.x},t)};u.prototype.scrollToBottom=function(e){this.scrollTo({y:-1*(this.el.clientHeight-this.container.clientHeight),x:0},e)};u.prototype.scrollToTop=function(e){this.scrollTo({x:0,y:0},e)};return f}()})(jq)